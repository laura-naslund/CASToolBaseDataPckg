usethis::use_data_raw()
usethis::use_r("retrieve_boundary")
usethis::use_r("retrieve_reaches")
devtools::load_all()
generate_data("Maryland")
generate_data <- function(state){
in.dir <- file.path(getwd(), "data-raw")
STATE.shp <- sf::read_sf(file.path(in.dir,"gadm41_USA_shp/gadm41_USA_1.shp")) %>%
dplyr::filter(NAME_1 == state) %>%
sf::st_transform(crs = 5070) %>%
sf::st_buffer(300) # add 300 m buffer to deal with simplified input shapefile geometry
assign(paste0(state, "_BoundaryShapefile"), STATE.shp)
do.call("use_data", list(as.name(paste0(state, "_BoundaryShapefile")), overwrite = TRUE))
qc_keep <- c("QC_04", "QC_05", "QC_08","QC_MA")
variables <- c("comid", tolower(qc_keep), "slope")
NHD.STATE <- nhdplusTools::get_nhdplus(AOI = STATE.shp) %>%
dplyr::filter(ftype %in% c("Connector", "CanalDitch", "StreamRiver", "Drainageway", "ArtificialPath"))  %>%
dplyr::select(all_of(variables))
new.names <- c(toupper(variables), "geometry")
colnames(NHD.STATE) <- paste(new.names)
assign(paste0(state, "_Reaches"), NHD.STATE)
do.call("use_data", list(as.name(paste0(state, "_Reaches")), overwrite = TRUE))
}
generate_data("Maryland")
